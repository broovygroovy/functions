<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Font Website</title>
<link
href="https://typography-interaction-2324.github.io/assets/reset.css"
rel="stylesheet"/>
<link href="style.css" rel="stylesheet"/>
</head>

<body>
  <div class="container">
    <h1>File List from /Library/Fonts Directory</h1>

    <input type="text" id="sampleTextInput" placeholder="Enter sample text" value="Aa Bb Cc Dd Ee">

    <button id="getFontsButton">Get Fonts List</button>

    <ul id="fileList"></ul>
  </div>

  <script>
    document.getElementById('getFontsButton').addEventListener('click', async function() {
      try {
        const fontsDirHandle = await window.showDirectoryPicker();
        const fileList = document.getElementById('fileList');
        fileList.innerHTML = ''; // Clear previous entries

        for await (const entry of fontsDirHandle.values()) {
          if (entry instanceof FileSystemFileHandle) {
            const li = document.createElement('li');
            li.classList.add('file-item'); // class for styling

            // File name
            const fileName = document.createElement('div');
            fileName.classList.add('file-name');
            fileName.textContent = entry.name;
            li.appendChild(fileName);

            // Sample text
            const sampleText = document.createElement('div');
            sampleText.classList.add('sample-text');
            li.appendChild(sampleText);

            fileList.appendChild(li);

            loadFont(entry, sampleText); // Load font and display sample text
          }
        }
      } catch (err) {
        console.error('Error accessing fonts directory:', err);
      }
    });

    async function loadFont(fileHandle, sampleTextElement) {
      const file = await fileHandle.getFile();
      const blob = new Blob([file], { type: 'font/ttf' });
      const fontUrl = URL.createObjectURL(blob);
      const fontName = fileHandle.name.split('.')[0]; // Extract font name from file name

      // Set @font-face rule dynamically
      const style = document.createElement('style');
      style.textContent = `
        @font-face {
          font-family: '${fontName}';
          src: url('${fontUrl}');
        }
      `;
      document.head.appendChild(style);

      // Apply loaded font to sample text
      sampleTextElement.style.fontFamily = fontName;
      sampleTextElement.textContent = document.getElementById('sampleTextInput').value;
    }

    // Update sample text for all font items when user types in the input box
    document.getElementById('sampleTextInput').addEventListener('input', function() {
      const sampleText = this.value;
      const sampleTextElements = document.querySelectorAll('.sample-text');
      sampleTextElements.forEach(function(sampleTextElement) {
        sampleTextElement.textContent = sampleText;
      });
    });
  </script>
</body>
</html>
